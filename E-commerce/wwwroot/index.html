<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Test SignalR</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.5/signalr.min.js"></script>
</head>
<body>
    <h1>Escuchando notificaciones de órdenes</h1>
    <ul id="messages"></ul>

    <script>
        const connection = new signalR.HubConnectionBuilder()
            .withUrl("/notifications", {
                accessTokenFactory: () => localStorage.getItem("jwt")
            })
      .configureLogging(signalR.LogLevel.Information)
      .build();

    connection.on("OrderProcessed", payload => {
      const li = document.createElement("li");
      li.textContent = `Orden ${payload.id} procesada: ${payload.status}`;
      document.getElementById("messages").appendChild(li);
    });

    connection.start()
      .then(() => console.log("Conectado al Hub"))
      .catch(err => console.error(err));
    </script>
</body>
</html>
